{"version":3,"file":"modal.js","sources":["../src/modal.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap (v5.2.0-alpha1): modal.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport { defineJQueryPlugin, getElementFromSelector, isRTL, isVisible, reflow } from './util/index'\nimport EventHandler from './dom/event-handler'\nimport SelectorEngine from './dom/selector-engine'\nimport ScrollBarHelper from './util/scrollbar'\nimport BaseComponent from './base-component'\nimport Backdrop from './util/backdrop'\nimport FocusTrap from './util/focustrap'\nimport { enableDismissTrigger } from './util/component-functions'\n\n/**\n * Constants\n */\n\nconst NAME = 'modal'\nconst DATA_KEY = 'bs.modal'\nconst EVENT_KEY = `.${DATA_KEY}`\nconst DATA_API_KEY = '.data-api'\nconst ESCAPE_KEY = 'Escape'\n\nconst EVENT_HIDE = `hide${EVENT_KEY}`\nconst EVENT_HIDE_PREVENTED = `hidePrevented${EVENT_KEY}`\nconst EVENT_HIDDEN = `hidden${EVENT_KEY}`\nconst EVENT_SHOW = `show${EVENT_KEY}`\nconst EVENT_SHOWN = `shown${EVENT_KEY}`\nconst EVENT_RESIZE = `resize${EVENT_KEY}`\nconst EVENT_KEYDOWN_DISMISS = `keydown.dismiss${EVENT_KEY}`\nconst EVENT_CLICK_DATA_API = `click${EVENT_KEY}${DATA_API_KEY}`\n\nconst CLASS_NAME_OPEN = 'modal-open'\nconst CLASS_NAME_FADE = 'fade'\nconst CLASS_NAME_SHOW = 'show'\nconst CLASS_NAME_STATIC = 'modal-static'\n\nconst OPEN_SELECTOR = '.modal.show'\nconst SELECTOR_DIALOG = '.modal-dialog'\nconst SELECTOR_MODAL_BODY = '.modal-body'\nconst SELECTOR_DATA_TOGGLE = '[data-bs-toggle=\"modal\"]'\n\nconst Default = {\n  backdrop: true,\n  keyboard: true,\n  focus: true\n}\n\nconst DefaultType = {\n  backdrop: '(boolean|string)',\n  keyboard: 'boolean',\n  focus: 'boolean'\n}\n\n/**\n * Class definition\n */\n\nclass Modal extends BaseComponent {\n  constructor(element, config) {\n    super(element, config)\n\n    this._dialog = SelectorEngine.findOne(SELECTOR_DIALOG, this._element)\n    this._backdrop = this._initializeBackDrop()\n    this._focustrap = this._initializeFocusTrap()\n    this._isShown = false\n    this._isTransitioning = false\n    this._scrollBar = new ScrollBarHelper()\n  }\n\n  // Getters\n  static get Default() {\n    return Default\n  }\n\n  static get DefaultType() {\n    return DefaultType\n  }\n\n  static get NAME() {\n    return NAME\n  }\n\n  // Public\n  toggle(relatedTarget) {\n    return this._isShown ? this.hide() : this.show(relatedTarget)\n  }\n\n  show(relatedTarget) {\n    if (this._isShown || this._isTransitioning) {\n      return\n    }\n\n    const showEvent = EventHandler.trigger(this._element, EVENT_SHOW, {\n      relatedTarget\n    })\n\n    if (showEvent.defaultPrevented) {\n      return\n    }\n\n    this._isShown = true\n    this._isTransitioning = true\n\n    this._scrollBar.hide()\n\n    document.body.classList.add(CLASS_NAME_OPEN)\n\n    this._adjustDialog()\n\n    this._toggleEscapeEventListener(true)\n    this._toggleResizeEventListener(true)\n\n    this._backdrop.show(() => this._showElement(relatedTarget))\n  }\n\n  hide() {\n    if (!this._isShown || this._isTransitioning) {\n      return\n    }\n\n    const hideEvent = EventHandler.trigger(this._element, EVENT_HIDE)\n\n    if (hideEvent.defaultPrevented) {\n      return\n    }\n\n    this._isShown = false\n    this._isTransitioning = true\n\n    this._toggleEscapeEventListener(false)\n    this._toggleResizeEventListener(false)\n\n    this._focustrap.deactivate()\n\n    this._element.classList.remove(CLASS_NAME_SHOW)\n\n    this._queueCallback(() => this._hideModal(), this._element, this._isAnimated())\n  }\n\n  dispose() {\n    for (const htmlElement of [window, this._dialog]) {\n      EventHandler.off(htmlElement, EVENT_KEY)\n    }\n\n    this._backdrop.dispose()\n    this._focustrap.deactivate()\n    super.dispose()\n  }\n\n  handleUpdate() {\n    this._adjustDialog()\n  }\n\n  // Private\n  _initializeBackDrop() {\n    const clickCallback = () => {\n      if (this._config.backdrop === 'static') {\n        this._triggerBackdropTransition()\n        return\n      }\n\n      this.hide()\n    }\n\n    // 'static' option will be translated to true, and booleans will keep their value\n    const isVisible = Boolean(this._config.backdrop)\n\n    return new Backdrop({\n      isVisible,\n      isAnimated: this._isAnimated(),\n      clickCallback: isVisible ? clickCallback : null\n    })\n  }\n\n  _initializeFocusTrap() {\n    return new FocusTrap({\n      trapElement: this._element\n    })\n  }\n\n  _showElement(relatedTarget) {\n    // try to append dynamic modal\n    if (!document.body.contains(this._element)) {\n      document.body.append(this._element)\n    }\n\n    this._element.style.display = 'block'\n    this._element.removeAttribute('aria-hidden')\n    this._element.setAttribute('aria-modal', true)\n    this._element.setAttribute('role', 'dialog')\n    this._element.scrollTop = 0\n\n    const modalBody = SelectorEngine.findOne(SELECTOR_MODAL_BODY, this._dialog)\n    if (modalBody) {\n      modalBody.scrollTop = 0\n    }\n\n    reflow(this._element)\n\n    this._element.classList.add(CLASS_NAME_SHOW)\n\n    const transitionComplete = () => {\n      if (this._config.focus) {\n        this._focustrap.activate()\n      }\n\n      this._isTransitioning = false\n      EventHandler.trigger(this._element, EVENT_SHOWN, {\n        relatedTarget\n      })\n    }\n\n    this._queueCallback(transitionComplete, this._dialog, this._isAnimated())\n  }\n\n  _toggleEscapeEventListener(enable) {\n    if (!enable) {\n      EventHandler.off(this._element, EVENT_KEYDOWN_DISMISS)\n      return\n    }\n\n    EventHandler.on(this._element, EVENT_KEYDOWN_DISMISS, event => {\n      if (event.key !== ESCAPE_KEY) {\n        return\n      }\n\n      if (this._config.keyboard) {\n        event.preventDefault()\n        this.hide()\n        return\n      }\n\n      this._triggerBackdropTransition()\n    })\n  }\n\n  _toggleResizeEventListener(enable) {\n    if (enable) {\n      EventHandler.on(window, EVENT_RESIZE, () => this._adjustDialog())\n      return\n    }\n\n    EventHandler.off(window, EVENT_RESIZE)\n  }\n\n  _hideModal() {\n    this._element.style.display = 'none'\n    this._element.setAttribute('aria-hidden', true)\n    this._element.removeAttribute('aria-modal')\n    this._element.removeAttribute('role')\n    this._isTransitioning = false\n\n    this._backdrop.hide(() => {\n      document.body.classList.remove(CLASS_NAME_OPEN)\n      this._resetAdjustments()\n      this._scrollBar.reset()\n      EventHandler.trigger(this._element, EVENT_HIDDEN)\n    })\n  }\n\n  _isAnimated() {\n    return this._element.classList.contains(CLASS_NAME_FADE)\n  }\n\n  _triggerBackdropTransition() {\n    const hideEvent = EventHandler.trigger(this._element, EVENT_HIDE_PREVENTED)\n    if (hideEvent.defaultPrevented) {\n      return\n    }\n\n    const isModalOverflowing = this._element.scrollHeight > document.documentElement.clientHeight\n    const initialOverflowY = this._element.style.overflowY\n    // return if the following background transition hasn't yet completed\n    if (initialOverflowY === 'hidden' || this._element.classList.contains(CLASS_NAME_STATIC)) {\n      return\n    }\n\n    if (!isModalOverflowing) {\n      this._element.style.overflowY = 'hidden'\n    }\n\n    this._element.classList.add(CLASS_NAME_STATIC)\n    this._queueCallback(() => {\n      this._element.classList.remove(CLASS_NAME_STATIC)\n      this._queueCallback(() => {\n        this._element.style.overflowY = initialOverflowY\n      }, this._dialog)\n    }, this._dialog)\n\n    this._element.focus()\n  }\n\n  /**\n   * The following methods are used to handle overflowing modals\n   */\n\n  _adjustDialog() {\n    const isModalOverflowing = this._element.scrollHeight > document.documentElement.clientHeight\n    const scrollbarWidth = this._scrollBar.getWidth()\n    const isBodyOverflowing = scrollbarWidth > 0\n\n    if (isBodyOverflowing && !isModalOverflowing) {\n      const property = isRTL() ? 'paddingLeft' : 'paddingRight'\n      this._element.style[property] = `${scrollbarWidth}px`\n    }\n\n    if (!isBodyOverflowing && isModalOverflowing) {\n      const property = isRTL() ? 'paddingRight' : 'paddingLeft'\n      this._element.style[property] = `${scrollbarWidth}px`\n    }\n  }\n\n  _resetAdjustments() {\n    this._element.style.paddingLeft = ''\n    this._element.style.paddingRight = ''\n  }\n\n  // Static\n  static jQueryInterface(config, relatedTarget) {\n    return this.each(function () {\n      const data = Modal.getOrCreateInstance(this, config)\n\n      if (typeof config !== 'string') {\n        return\n      }\n\n      if (typeof data[config] === 'undefined') {\n        throw new TypeError(`No method named \"${config}\"`)\n      }\n\n      data[config](relatedTarget)\n    })\n  }\n}\n\n/**\n * Data API implementation\n */\n\nEventHandler.on(document, EVENT_CLICK_DATA_API, SELECTOR_DATA_TOGGLE, function (event) {\n  const target = getElementFromSelector(this)\n\n  if (['A', 'AREA'].includes(this.tagName)) {\n    event.preventDefault()\n  }\n\n  EventHandler.one(target, EVENT_SHOW, showEvent => {\n    if (showEvent.defaultPrevented) {\n      // only register focus restorer if modal will actually get shown\n      return\n    }\n\n    EventHandler.one(target, EVENT_HIDDEN, () => {\n      if (isVisible(this)) {\n        this.focus()\n      }\n    })\n  })\n\n  // avoid conflict when clicking modal toggler while another one is open\n  const alreadyOpen = SelectorEngine.findOne(OPEN_SELECTOR)\n  if (alreadyOpen) {\n    Modal.getInstance(alreadyOpen).hide()\n  }\n\n  const data = Modal.getOrCreateInstance(target)\n\n  data.toggle(this)\n})\n\nenableDismissTrigger(Modal)\n\n/**\n * jQuery\n */\n\ndefineJQueryPlugin(Modal)\n\nexport default Modal\n"],"names":["NAME","DATA_KEY","EVENT_KEY","DATA_API_KEY","ESCAPE_KEY","EVENT_HIDE","EVENT_HIDE_PREVENTED","EVENT_HIDDEN","EVENT_SHOW","EVENT_SHOWN","EVENT_RESIZE","EVENT_KEYDOWN_DISMISS","EVENT_CLICK_DATA_API","CLASS_NAME_OPEN","CLASS_NAME_FADE","CLASS_NAME_SHOW","CLASS_NAME_STATIC","OPEN_SELECTOR","SELECTOR_DIALOG","SELECTOR_MODAL_BODY","SELECTOR_DATA_TOGGLE","Default","backdrop","keyboard","focus","DefaultType","Modal","BaseComponent","constructor","element","config","_dialog","SelectorEngine","findOne","_element","_backdrop","_initializeBackDrop","_focustrap","_initializeFocusTrap","_isShown","_isTransitioning","_scrollBar","ScrollBarHelper","toggle","relatedTarget","hide","show","showEvent","EventHandler","trigger","defaultPrevented","document","body","classList","add","_adjustDialog","_toggleEscapeEventListener","_toggleResizeEventListener","_showElement","hideEvent","deactivate","remove","_queueCallback","_hideModal","_isAnimated","dispose","htmlElement","window","off","handleUpdate","clickCallback","_config","_triggerBackdropTransition","isVisible","Boolean","Backdrop","isAnimated","FocusTrap","trapElement","contains","append","style","display","removeAttribute","setAttribute","scrollTop","modalBody","reflow","transitionComplete","activate","enable","on","event","key","preventDefault","_resetAdjustments","reset","isModalOverflowing","scrollHeight","documentElement","clientHeight","initialOverflowY","overflowY","scrollbarWidth","getWidth","isBodyOverflowing","property","isRTL","paddingLeft","paddingRight","jQueryInterface","each","data","getOrCreateInstance","TypeError","target","getElementFromSelector","includes","tagName","one","alreadyOpen","getInstance","enableDismissTrigger","defineJQueryPlugin"],"mappings":"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"}